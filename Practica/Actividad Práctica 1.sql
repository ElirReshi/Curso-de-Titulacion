/*
    Fecha: 17/02/2016
    Nombre: Sander Pacheco H.
    Ejercicios de Consultas Simples:
*/

-- 1. Listar las oficinas de ventas con sus objetivos y ventas reales.

select oficina, objetivo, ventas
from Oficinas;

/*

------------------------------------------------------
|  oficina   |     objetivo      |      ventas       |
------------------------------------------------------
|         11 |      575.000,00 € |      692.637,00 € |
------------------------------------------------------
|         12 |      800.000,00 € |      735.042,00 € |
------------------------------------------------------
|         13 |      350.000,00 € |      367.911,00 € |
------------------------------------------------------
|         21 |      725.000,00 € |      835.915,00 € |
------------------------------------------------------
|         22 |      300.000,00 € |      186.042,00 € |
------------------------------------------------------

*/

-- 2. Listar las oficinas de ventas de la región Este con sus objetivos y ventas.

-- access
/*

select oficina, objetivo, ventas
from Oficinas
where region = "Este"

*/

-- SQL Server
select oficina, objetivo, ventas
from Oficinas
where region = 'Este';

/*

------------------------------------------------------
|  oficina   |     objetivo      |      ventas       |
------------------------------------------------------
|         11 |      575.000,00 € |      692.637,00 € |
------------------------------------------------------
|         12 |      800.000,00 € |      735.042,00 € |
------------------------------------------------------
|         13 |      350.000,00 € |      367.911,00 € |
------------------------------------------------------

*/

-- 3. Listar las oficinas de ventas de la región Este cuyas ventas exceden a sus objetivos.

-- access
/*

select oficina, objetivo, ventas
from Oficinas
where region = "Este" and ventas > objetivo

*/

-- SQL Server
select oficina, objetivo, ventas
from Oficinas
where region = 'Este' and ventas > objetivo;

/*

------------------------------------------------------
|  oficina   |     objetivo      |      ventas       |
------------------------------------------------------
|         11 |      575.000,00 € |      692.637,00 € |
------------------------------------------------------
|         13 |      350.000,00 € |      367.911,00 € |
------------------------------------------------------

*/

-- 4. Listar los nombres, oficinas y fechas de contrato de todos los vendedores.

select nombre, oficina_vend , contrato as 'fecha de contrato'
from Vendedores;

/*

-------------------------------------------------------------
|      nombre       |   oficina_vend    |    'fecha de      |
-------------------------------------------------------------
| Dan Roberts       |                12 |        20/10/1986 |
-------------------------------------------------------------
| Sue Smith         |                21 |        10/12/1986 |
-------------------------------------------------------------
| Paul Cruz         |                12 |        01/03/1987 |
-------------------------------------------------------------
| Bob Smith         |                12 |        19/05/1987 |
-------------------------------------------------------------
| Bill Adams        |                13 |        12/02/1988 |
-------------------------------------------------------------
| Sam  Clark        |                11 |        14/06/1988 |
-------------------------------------------------------------
| Nancy Angelli     |                22 |        14/11/1988 |
-------------------------------------------------------------
| Larry Fitch       |                21 |        12/10/1989 |
-------------------------------------------------------------
| Mary Jones        |                11 |        12/10/1999 |
-------------------------------------------------------------
| Tom Snyder        |                   |        13/01/1990 |
-------------------------------------------------------------

*/

-- 5. ¿Cuál es el nombre, cuota y ventas del empleado número 107?

select nombre, cuota, ventas
from Vendedores
where num_empl = 107;

/*

-------------------------------------------------------------
|      nombre       |       cuota       |      ventas       |
-------------------------------------------------------------
| Nancy Angelli     |      300.000,00 € |      186.042,00 € |
-------------------------------------------------------------

*/

-- 6. Listar el nombre y fecha de contrato de cualquier vendedor cuyas ventas sean superiores a 500000.

select nombre, contrato as 'Fecha de Contrato'
from Vendedores
where ventas > 500000;

/*

--------------------------------------------------------
|      nombre       |       'fecha de contrato'        |
--------------------------------------------------------

*/

-- 7. Listar todos los nombres de los vendedores, sus cuotas y directores.

select nombre, cuota, director
from Vendedores;

/*

-------------------------------------------------------------
|      nombre       |       cuota       |     director      |
-------------------------------------------------------------
| Dan Roberts       |      300.000,00 € |               104 |
-------------------------------------------------------------
| Sue Smith         |      350.000,00 € |               108 |
-------------------------------------------------------------
| Paul Cruz         |      275.000,00 € |               104 |
-------------------------------------------------------------
| Bob Smith         |      200.000,00 € |               106 |
-------------------------------------------------------------
| Bill Adams        |      350.000,00 € |               104 |
-------------------------------------------------------------
| Sam  Clark        |      275.000,00 € |                   |
-------------------------------------------------------------
| Nancy Angelli     |      300.000,00 € |               108 |
-------------------------------------------------------------
| Larry Fitch       |      350.000,00 € |               106 |
-------------------------------------------------------------
| Mary Jones        |      300.000,00 € |               106 |
-------------------------------------------------------------
| Tom Snyder        |            0,00 € |               101 |
-------------------------------------------------------------

*/

-- 8. Mostrar que sucederá si se eleva la cuota de cada vendedor en un 3% de sus ventas anuales

select num_empl, nombre, cuota, ventas, (cuota + (ventas * 0.03)) as 'cuota más 3%'
from Vendedores;

/*

-----------------------------------------------------------------------------------------------------------
| num_empl |      nombre       |       cuota       |      ventas       |          'cuota mas 3%'          |
-----------------------------------------------------------------------------------------------------------
|      101 | Dan Roberts       |      300.000,00 € |      305.673,00 € |                        309170,19 |
-----------------------------------------------------------------------------------------------------------
|      102 | Sue Smith         |      350.000,00 € |      474.050,00 € |                         364221,5 |
-----------------------------------------------------------------------------------------------------------
|      103 | Paul Cruz         |      275.000,00 € |      286.775,00 € |                        283603,25 |
-----------------------------------------------------------------------------------------------------------
|      104 | Bob Smith         |      200.000,00 € |      142.594,00 € |                        204277,82 |
-----------------------------------------------------------------------------------------------------------
|      105 | Bill Adams        |      350.000,00 € |      367.911,00 € |                        361037,33 |
-----------------------------------------------------------------------------------------------------------
|      106 | Sam  Clark        |      275.000,00 € |      299.912,00 € |                        283997,36 |
-----------------------------------------------------------------------------------------------------------
|      107 | Nancy Angelli     |      300.000,00 € |      186.042,00 € |                        305581,26 |
-----------------------------------------------------------------------------------------------------------
|      108 | Larry Fitch       |      350.000,00 € |      361.865,00 € |                        360855,95 |
-----------------------------------------------------------------------------------------------------------
|      109 | Mary Jones        |      300.000,00 € |      392.725,00 € |                        311781,75 |
-----------------------------------------------------------------------------------------------------------
|      110 | Tom Snyder        |            0,00 € |       75.985,00 € |                          2279,55 |
-----------------------------------------------------------------------------------------------------------

*/

-- 9. Muestra los empleados dirigidos por Bob Smith (empleado 104).

select *
from Vendedores
where director = 104;

/*

-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
| num_empl |      nombre       |    edad    |     oficina_vend      |      titulo       |     contrato      |     director      |       cuota       |      ventas       |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|      101 | Dan Roberts       |         45 |                    12 | Rep Ventas        |        20/10/1986 |               104 |      300.000,00 € |      305.673,00 € |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|      103 | Paul Cruz         |         29 |                    12 | Rep Ventas        |        01/03/1987 |               104 |      275.000,00 € |      286.775,00 € |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|      105 | Bill Adams        |         37 |                    13 | Rep Ventas        |        12/02/1988 |               104 |      350.000,00 € |      367.911,00 € |
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------

*/
